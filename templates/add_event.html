{% extends "base.html" %}

{% block title %}Add Event{% endblock %}

{% block head %}
<link href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
{% endblock %}

{% block content %}
<h2>Add Event</h2>
<form method="POST" action="/add-event">
    {{ form.hidden_tag() }}
    <div class="form-group">
        {{ form.title.label(class="form-control-label") }}
        {{ form.title(class="form-control") }}
    </div>
    <div class="form-group">
        {{ form.start.label(class="form-control-label") }}
        {{ form.start(class="form-control", id="start-picker") }}
    </div>
    <div class="form-group">
        {{ form.end.label(class="form-control-label") }}
        {{ form.end(class="form-control", id="end-picker") }}
    </div>
    <div class="form-group">
        {{ form.description.label(class="form-control-label") }}
        {{ form.description(class="form-control") }}
    </div>
    <div class="form-group">
        {{ form.all_day.label(class="form-control-label") }}
        {{ form.all_day(class="form-check-input") }}
    </div>
    <div class="form-group">
        {{ form.location.label(class="form-control-label") }}
        {{ form.location(class="form-control") }}
    </div>
    <div class="form-group">
        {{ form.color.label(class="form-control-label") }}
        {{ form.color(class="form-control") }}
    </div>
    <div class="form-group">
        {{ form.recurrence.label(class="form-control-label") }}
        {{ form.recurrence(class="form-control") }}
    </div>
    <div class="form-group">
        {{ form.recurrence_end.label(class="form-control-label") }}
        {{ form.recurrence_end(class="form-control", id="recurrence-end-picker") }}
    </div>
    <div class="form-group">
        {{ form.submit(class="btn btn-primary") }}
    </div>
</form>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        flatpickr("#start-picker", {
            enableTime: true,
            dateFormat: "Y-m-d H:i:S",
            defaultDate: "{{ form.start.data.strftime('%Y-%m-%d %H:%M:%S') }}"
        });
        flatpickr("#end-picker", {
            enableTime: true,
            dateFormat: "Y-m-d H:i:S",
            defaultDate: "{{ form.end.data.strftime('%Y-%m-%d %H:%M:%S') }}"
        });
        flatpickr("#recurrence-end-picker", {
            enableTime: true,
            dateFormat: "Y-m-d H:i:S",
            defaultDate: "{{ form.recurrence_end.data.strftime('%Y-%m-%d %H:%M:%S') if form.recurrence_end.data else '' }}"
        });
    });
</script>
{% endblock %}
