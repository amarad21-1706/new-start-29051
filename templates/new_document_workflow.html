<!DOCTYPE html>
<html lang="en">
<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>Document Workflow Manager</title>
   <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
   <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
   <div class="container mt-5">
       <h1>Document Workflow Manager</h1>

       <!-- Document Selection -->
       <div class="form-group">
           <label for="number_of_doc">Select Document</label>
           <select class="form-control" id="number_of_doc">
               <!-- Options will be dynamically populated -->
           </select>
       </div>

       <!-- Document Details -->
       <div class="form-group">
           <label for="fi0">FI0</label>
           <input type="text" class="form-control" id="fi0" readonly>
       </div>
       <div class="form-group">
           <label for="interval_ord">Interval</label>
           <input type="text" class="form-control" id="interval_ord" readonly>
       </div>
       <div class="form-group">
           <label for="subject">Subject</label>
           <input type="text" class="form-control" id="subject" readonly>
       </div>

       <!-- Inline Workflows -->
       <h3>Workflows</h3>
       <div id="inline_workflows">
           <!-- Inline workflows will be populated here dynamically -->
       </div>

       <!-- Submit Button -->
       <button class="btn btn-primary mt-3" id="submit_btn">Submit</button>
   </div>

   <script>
       $(document).ready(function() {
           // Load documents into the dropdown using the correct API route
           $.ajax({
               url: '/api/documents_workflow_new',  // Corrected route
               method: 'GET',
               success: function(data) {
                   // Populate document dropdown
                   data.forEach(function(doc) {
                       $('#number_of_doc').append(
                           `<option value="${doc.id}">${doc.name}</option>`
                       );
                   });
               },
               error: function() {
                   alert('Error fetching documents');
               }
           });

           // Handle document selection
           $('#number_of_doc').change(function() {
               var docId = $(this).val();

               // Fetch document details and workflows for selected document
               $.ajax({
                   url: '/api/documents_workflow_new',  // Corrected route
                   method: 'GET',
                   success: function(data) {
                       console.log(data);  // Log the response data
                       // Populate document dropdown
                       data.forEach(function(doc) {
                           $('#number_of_doc').append(
                               `<option value="${doc.id}">${doc.name}</option>`
                           );
                       });
                   },
                   error: function() {
                       alert('Error fetching documents');
                   }
                });

           });

           // Handle form submission (optional)
           $('#submit_btn').click(function() {
               alert('Form Submitted');
           });
       });
   </script>
</body>
</html>
