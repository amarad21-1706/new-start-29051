{% extends "base.html" %}

{% block title %}
Registration Checklist
{% endblock %}

{% block content %}
<h2>Registration Progress</h2>

<!-- Inline CSS to increase font size and style checks -->
<style>
    table {
        font-size: 18px; /* Adjust the font size as needed */
    }
    th, td {
        padding: 10px; /* Optional: Adds padding for better readability */
        text-align: center;
    }
    .check-mark {
        color: green;
        font-size: 24px; /* Larger size for the check mark */
    }
    .cross-mark {
        color: red;
        font-size: 24px; /* Larger size for the cross mark */
    }
</style>

<!-- Display flash messages -->
{% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
    <div class="flash-messages">
      {% for category, message in messages %}
        <div class="alert alert-{{ category }}">{{ message }}</div>
      {% endfor %}
    </div>
  {% endif %}
{% endwith %}

<table border="1">
    <tr>
        <th>Step</th>
        <th>Status</th>
        <th>Action</th>
    </tr>
    <tr>
        <td>1. You have already registered</td>
        <td>
            <span class="{{ 'check-mark' if checklist['user_exists'] else 'cross-mark' }}">
                {{ '✔' if checklist['user_exists'] else '❌' }}
            </span>
        </td>
        <td>N/A</td>
    </tr>
    <tr>
        <td>2. Agreement Signed</td>
        <td>
            <span class="{{ 'check-mark' if checklist['agreement_signed'] else 'cross-mark' }}">
                {{ '✔' if checklist['agreement_signed'] else '❌' }}
            </span>
        </td>
        <td>
            {% if not checklist['agreement_signed'] %}
                <form method="post" action="{{ url_for('sign_agreement') }}">
                    {{ csrf_token }}
                    <button type="submit">Sign Agreement</button>
                </form>
            {% endif %}
        </td>
    </tr>
    <tr>
        <td>3. Membership Granted</td>
        <td>
            <span class="{{ 'check-mark' if checklist['role_assigned'] else 'cross-mark' }}">
                {{ '✔' if checklist['role_assigned'] else '❌' }}
            </span>
        </td>
        <td>
            {% if not checklist['role_assigned'] %}
                {% if checklist['role_requested'] %}
                    Membership request submitted
                {% else %}
                    <form method="post" action="{{ url_for('request_role') }}">
                        {{ csrf_token }}
                        <button type="submit">Request Membership</button>
                    </form>
                {% endif %}
            {% endif %}
        </td>
    </tr>

    <tr>
        <td>4. Company Assigned</td>
        <td>
            <span class="{{ 'check-mark' if checklist['company_assigned'] else 'cross-mark' }}">
                {{ '✔' if checklist['company_assigned'] else '❌' }}
            </span>
        </td>
        <td>
            {% if not checklist['company_assigned'] %}
                {% if checklist['assignment_requested'] %}
                    Assignment requested
                {% else %}
                    <form method="post" action="{{ url_for('request_company') }}">
                        {{ csrf_token }}
                        <button type="submit">Request Company Assignment</button>
                    </form>
                {% endif %}
            {% endif %}
        </td>
    </tr>
    <tr>
        <td>5. Service Subscription</td>
        <td>
            <span class="{{ 'check-mark' if checklist['service_subscribed'] else 'cross-mark' }}">
                {{ '✔' if checklist['service_subscribed'] else '❌' }}
            </span>
        </td>
        <td>
            {% if not checklist['service_subscribed'] %}
                <form method="post" action="{{ url_for('subscribe_service') }}">
                    {{ csrf_token }}
                    <button type="submit">Subscribe to Service</button>
                </form>
            {% endif %}
        </td>
    </tr>
    <tr>
        <td>6. Plan Options</td>
        <td>
            <span class="{{ 'check-mark' if checklist['plan_opted'] else 'cross-mark' }}">
                {{ '✔' if checklist['plan_opted'] else '❌' }}
            </span>
        </td>
        <td>
            {% if checklist['plan_opted'] %}
                Plans: {{ checklist['plan_names'] }}
            {% else %}
                <form method="post" action="{{ url_for('opt_plan') }}">
                    {{ csrf_token }}
                    <button type="submit">Opt for Plan</button>
                </form>
            {% endif %}
        </td>
    </tr>

</table>
{% endblock %}
